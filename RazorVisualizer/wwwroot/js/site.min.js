(function(n){function u(n,t){cm.markText(cm.posFromIndex(n),cm.posFromIndex(n+t),{clearOnEnter:!0,className:"highlight"})}function f(n,t){var i=cm.findMarks(cm.posFromIndex(n),cm.posFromIndex(n+t));for(var r of i)r.clear()}function i(t){n.ajax({url:"api/Parse",dataType:"json",type:"post",cache:!1,contentType:"application/json",data:JSON.stringify({content:t}),success:function(t){var i=n("<ul />");r(t,i,0);n("#results").html(i)},error:function(n,t,i){console.log("error: "+i)}})}function e(t){return n("<div/>").text(t).html()}function r(t,i,o){var c,l,a,h,v,s;if(t!=null&&(c="children"+o,l=n("<span />").html(e(t.Content)),l.hover(function(){u(t.Start,t.Length)},function(){f(t.Start,t.Length)}),a=n("<li />").attr({"data-toggle":"collapse","data-target":"#"+c}).html(l),i.append(a),h=t.Children,h&&h.length)){a.attr("class","block");v=n("<ul />").attr({"class":"collapse in",id:c});for(s of h)r(s,v,o+1),s.Children&&s.Children.length&&(o+=s.Children.length);i.append(v)}}var t=`@{
    var foo = "Hello World!";
}

<div>@foo</div>`;n(document).ready(function(){n("textarea#source").val(t);i(t);cm=CodeMirror.fromTextArea(n("textarea#source")[0],{lineNumbers:!0,mode:"htmlmixed",indentUnit:4,autofocus:!0});cm.on("change",function(n){i(n.getValue())})})})(jQuery);