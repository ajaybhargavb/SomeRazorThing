(function(n){function e(n,t){cm.markText(cm.posFromIndex(n),cm.posFromIndex(n+t),{clearOnEnter:!0,className:"highlight"})}function o(n,t){var i=cm.findMarks(cm.posFromIndex(n),cm.posFromIndex(n+t));for(var r of i)r.clear()}function r(t){n.ajax({url:"api/Parse",dataType:"json",type:"post",cache:!1,contentType:"application/json",data:JSON.stringify({content:t}),success:function(t){var r=n("<ul />");i(t,r,0);n("#results").html(r)},error:function(n,t,i){console.log("error: "+i)}})}function u(t){n.ajax({url:"api/ParseIR",dataType:"json",type:"post",cache:!1,contentType:"application/json",data:JSON.stringify({content:t}),success:function(t){var i=n("<ul />");n("#irtree").html(t)},error:function(n,t,i){console.log("error: "+i)}})}function f(t){n.ajax({url:"api/NewParse",dataType:"json",type:"post",cache:!1,contentType:"application/json",data:JSON.stringify({content:t}),success:function(t){var r=n("<ul />");i(t,r,0);n("#newtree").html(r)},error:function(n,t,i){console.log("error: "+i)}})}function s(t){return n("<div/>").text(t).html()}function i(t,r,u){var c,l,a,h,v,f;if(t!=null&&(c="children"+u,l=n("<span />").html(s(t.Content)),l.hover(function(){e(t.Start,t.Length)},function(){o(t.Start,t.Length)}),a=n("<li />").attr({"data-toggle":"collapse","data-target":"#"+c}).html(l),r.append(a),h=t.Children,h&&h.length)){a.attr("class","block");v=n("<ul />").attr({"class":"collapse in",id:c});for(f of h)i(f,v,u+1),f.Children&&f.Children.length&&(u+=f.Children.length);r.append(v)}}var t=`@{
    var foo = "Hello World!";
}

<div>@foo</div>`;n(document).ready(function(){n("textarea#source").val(t);r(t);u(t);f(t);cm=CodeMirror.fromTextArea(n("textarea#source")[0],{lineNumbers:!0,mode:"htmlmixed",indentUnit:4,autofocus:!0});cm.on("change",function(n){r(n.getValue());u(n.getValue());f(n.getValue())})})})(jQuery);